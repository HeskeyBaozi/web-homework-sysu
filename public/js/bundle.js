/*!
 * web-homework-sysu 0.0.0 - Modern Web Programming HomeWork - SYSU
 * Copyright (c) 2016 He Zhiyu - https://github.com/HeskeyBaozi/web-homework-sysu#readme
 * License: MIT
 */
!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=n(8),i=r(o),a=n(12),u=r(a),s=n(3),c=n(1),l=n(13),f=n(2),d=n(6),p=new i["default"]({target:".container",data:{imgUrl:"",blockMap:Array.from(document.querySelectorAll(".block")).map(function(e,t){return{element:e,correctIndex:t}}),startButton:"Start!",gameState:l.Type.Unstarted,isRunning:!1,isWinner:!1,time:0,count:0,message:"Welcome to play the Puzzle!!",stepNumber:20}}),h={blankElement:document.querySelector("#blk-15"),loadingElement:document.querySelector("#loading"),btnElement:document.querySelector("#start"),selectorsElement:document.querySelector(".img-groups"),updater:s.update.bind(p)};p.$watch("imgUrl",function(e,t){var n=new Image,r=this.blockMap.map(function(e){return e.element.getContext("2d")});n.src=e,n.onload=function(){(0,s.drawCanvas)(r,n)}}),p.imgUrl="./img/panda.jpg",p.$watch("gameState",function(e,t){var n=this;switch(function(){switch(e){case l.Type.Pending:n.time=0,n.count=0,n.isWinner=!1,n.message="Game Starting...",h.selectorsElement.classList.add("no-see");var t=setInterval(function(){n.gameState===l.Type.Pending?n.time++:clearInterval(t)},1e3)}}(),t){case l.Type.Pending:this.message=(this.isWinner?"Congratulations!":"Try your best.")+" Time:"+this.time+", Count:"+this.count,this.isWinner&&(this.startButton="Start!",h.selectorsElement.classList.remove("no-see")),this.time=0,this.count=0}}),p.$watch("isRunning",function(e){e?(h.btnElement.classList.add("disable-click"),h.selectorsElement.classList.add("no-see")):h.btnElement.classList.remove("disable-click")}),(0,u["default"])(".playground").on("click",function(e){e.preventDefault();var t=(0,s.getterFactory)(p.blockMap,f.selectElement),n=(0,s.move)(t(e.target),t(h.blankElement),p.blockMap);n&&(s.update.call(p,n.state),p.blockMap.every(function(e,t){return e.correctIndex===t})&&(p.isWinner=!0,p.gameState=l.Type.Unstarted),p.gameState===l.Type.Pending&&p.count++)}),(0,u["default"])("#start").on("click",function(e){if(e.preventDefault(),!p.isRunning)switch(p.gameState){case l.Type.Unstarted:p.startButton="Mixing...",(0,s.mix)(p,h.blankElement,h.updater,f.selectElement).then(function(){p.isRunning=!1,p.startButton="Give Up : (",p.gameState=l.Type.Pending});break;case l.Type.Pending:new Promise(function(e,t){p.gameState=l.Type.Unstarted,p.startButton="Getting Solution...",h.loadingElement.classList.remove("disable-see");var n=(0,s.getterFactory)(p.blockMap,f.selectElement);setTimeout(function(){e((0,d.AStar)(new c.Node(p.blockMap,n(h.blankElement),null)))},20)}).then(function(e){for(var t=[],n=e;n.parentNode;)t.push(n),n=n.parentNode;return new Promise(function(e,n){p.isRunning=!0,h.loadingElement.classList.add("disable-see"),p.startButton="Recovering...",(0,s.showSolutionAsync)(t,h.updater,e)})}).then(function(){h.selectorsElement.classList.remove("no-see"),p.startButton="Try Again! : )",p.isRunning=!1})}}),(0,u["default"])(".img-groups").on("click",function(e){if(e.preventDefault(),p.gameState===l.Type.Unstarted){var t=l.Img.find(function(t){return t.name===e.target.id});p.imgUrl=t.url.img}}),console.log(p)},function(e,t,n){"use strict";function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=t.Node=void 0;var u=n(2);t.Node=function s(e,t,n){i(this,s),this.state=e,this.blankTargetIndex=t,this.parentNode=n,this.depth=null!==n?n.depth+1:0,this.h=this.state.map(u.selectNumber).map(function(e,t){return Math.abs(e%4-t%4)+Math.abs(Math.floor(e/4)-Math.floor(t/4))}).reduce(function(e,t){return e+t},0)},t.PriorityQueue=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.push(null),n.compare=e,n.enqueue=function(e){this.push(e);for(var t=this.length-1;t>1;){var n=t>>1;if(!(this.compare(this[t],this[n])<0))break;a(this,n,t),t=n}},n.dequeue=function(){var e=this,t=this[1];this[1]=this.pop(),2===this.length&&this.pop();for(var n=[1],r=function(){var t=n.shift(),r=t,o=[t<<1,t<<1|1];o.filter(function(t){return t<e.length}).forEach(function(t){e.compare(e[t],e[r])<0&&(r=t)}),t!==r&&(a(e,t,r),n.push(r))};n.length;)r();return t},n.empty=function(){return this.length<=1},n}return o(t,e),t}(Array)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.selectElement=function(e){return e.element},t.selectNumber=function(e){return e.correctIndex},t.selectOriginal=function(e){return e}},function(e,t,n){"use strict";function r(e,t,n){if(s(e).some(function(e){return e===t})){var r=n.slice(),o=[n[t],n[e]];return r[e]=o[0],r[t]=o[1],{state:r,blankTargetIndex:e,parentState:n}}}function o(e,t){var n=r(e,t.blankTargetIndex,t.state);return new v.Node(n.state,n.blankTargetIndex,t)}function i(e,t,n){function o(i,a,u,c){var f=l(s(a).filter(function(e){return e!==i})),d=r(f,a,u);c(d.state),e?setTimeout(function(){e--,o(a,d.blankTargetIndex,d.state,c)},t):n(d)}return e--,o}function a(e){var t=f(e,this.blockMap);d(t,e),this.blockMap=e}function u(e,t){return[{X:0,Y:-1},{X:1,Y:0},{X:0,Y:1},{X:-1,Y:0}].map(function(t){return{X:e%4+t.X,Y:Math.floor(e/4)+t.Y}}).filter(function(e){return e.X>=0&&e.X<4&&e.Y>=0&&e.Y<4}).map(function(e){return t[e.X+4*e.Y]})}function s(e){return[{X:0,Y:-1},{X:1,Y:0},{X:0,Y:1},{X:-1,Y:0}].map(function(t){return{X:e%4+t.X,Y:Math.floor(e/4)+t.Y}}).filter(function(e){return e.X>=0&&e.X<4&&e.Y>=0&&e.Y<4}).map(function(e){return 4*e.Y+e.X})}function c(e,t){return function(n){return e.map(t).findIndex(function(e){return e===n})}}function l(e){return e[(0,y.getRandomInt)(0,e.length-1)]}function f(e,t){var n=[];return e.forEach(function(e,r){var o=t[r];e.correctIndex!==o.correctIndex&&n.push({before:o.correctIndex,after:e.correctIndex,index:r})}),n}function d(e,t){e.forEach(function(e){var n=t[e.index].element;n.className=n.className.replace(/order-\d*/,"order-"+e.index)})}function p(e,t,n){e.length?(t(e.pop().state),setTimeout(function(){p(e,t,n)},120)):n(e)}function h(e,t){e.forEach(function(e,n){e.drawImage(t,n%4*(t.width/4),Math.floor(n/4)*(t.height/4),t.width/4,t.height/4,0,0,100,100)});var n=e[e.length-1];n.fillStyle="rgba(120, 120, 120, 0.7)",n.fillRect(0,0,100,100)}function m(e,t,n,r){var o=c(e.blockMap,r),a=[t,o,s,l].reduce(function(e,t){return t(e)});return new Promise(function(r,u){e.isRunning=!0,i(e.stepNumber,120,r)(a,o(t),e.blockMap,n)})}Object.defineProperty(t,"__esModule",{value:!0}),t.move=r,t.search=o,t.randomlySelectAndMoveAsync=i,t.update=a,t.getNeighbours=u,t.getNeighboursIndex=s,t.getterFactory=c,t.getSample=l,t.showSolutionAsync=p,t.drawCanvas=h,t.mix=m;var y=n(14),v=n(1)},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){u.target&&s.push(u.target),u.target=e}function o(){u.target=s.pop()}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.pushTarget=r,t.popTarget=o;var a=0,u=function(){function e(){n(this,e),this.id=a++,this.subs=[]}return i(e,[{key:"addSub",value:function(e){this.subs.push(e)}},{key:"depend",value:function(){e.target&&e.target.addDependency(this)}},{key:"notify",value:function(){var e=this.subs.slice();e.forEach(function(e){e.update()})}}]),e}();t["default"]=u,u.target=null;var s=[]},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=function(){};return"function"==typeof e?t=e:"string"==typeof e?t=new Function("model","return model."+e+";"):console.warn(e+" fail to parse!!"),t}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.getGetter=o;var u=n(4),s=function(){function e(t,n,i){r(this,e),this.callback=i,this.model=t,this.newDepIds=new Set,this.newDeps=[],this._getter=o(n),this.value=this.get()}return a(e,[{key:"get",value:function(){(0,u.pushTarget)(this);var e=this._getter.call(this.model,this.model);return(0,u.popTarget)(),e}},{key:"addDependency",value:function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),e.addSub(this))}},{key:"update",value:function(){return this.run(),this}},{key:"run",value:function(){var e=this.get();if(e!==this.value||"object"===("undefined"==typeof e?"undefined":i(e))){var t=this.value;this.value=e,this.callback.call(this.model,e,t)}}}]),e}();t["default"]=s},function(e,t,n){"use strict";function r(e){var t=new a.PriorityQueue(function(e,t){return 4*e.h+e.depth-(4*t.h+t.depth)});t.enqueue(e);var n=new Set;console.time("AStar算法用时");for(var r=function(){var e=t.dequeue();if(e.state.map(u.selectNumber).every(function(e,t){return e===t}))return console.timeEnd("AStar算法用时"),{v:e};var r=(0,s.getNeighboursIndex)(e.blankTargetIndex);r.forEach(function(r){var o=(0,s.search)(r,e),i=o.state.map(u.selectNumber).toString();n.has(i)||(t.enqueue(o),n.add(i))})};!t.empty();){var o=r();if("object"===("undefined"==typeof o?"undefined":i(o)))return o.v}}function o(e){var t=[e],n=e.h;for(console.time("IDAStar");n;){for(var r=function(){var e=t.pop();if(e.state.map(u.selectNumber).every(function(e,t){return e===t}))return console.timeEnd("IDAStar"),{v:e};var r=(0,s.getNeighboursIndex)(e.blankTargetIndex);r.forEach(function(r){var o=(0,s.search)(r,e),i=o.h+o.depth;i<=n&&(t.push(o),console.log(t))})};t.length;){var o=r();if("object"===("undefined"==typeof o?"undefined":i(o)))return o.v}t.push(e),n++}}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.AStar=r,t.IDAStar=o;var a=n(1),u=n(2),s=n(3)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=e.childNodes,r=!0,a=!1,u=void 0;try{for(var s,c=n[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;3===l.nodeType?i(l,t):1===l.nodeType&&o(l,t)}}catch(f){a=!0,u=f}finally{try{!r&&c["return"]&&c["return"]()}finally{if(a)throw u}}}function i(e,t){var n=a(e.textContent);if(n){var r=document.createDocumentFragment();n.forEach(function(e){var n=void 0;e.expression?(n=document.createTextNode((0,u.getGetter)(e.expression)(t)),t._watchers.push(new s["default"](t,e.expression,function(e,t){n.textContent=e}))):n=document.createTextNode(e.value),r.appendChild(n)});var o=e.parentNode;o.replaceChild(r,e)}}function a(e){if(c.test(e)){for(var t=[],n=c.lastIndex=0,r=void 0,o=void 0;r=c.exec(e);){o=r.index,o>n&&t.push({value:e.slice(n,o)});var i=r[1];t.push({expression:i,value:i}),n=o+r[0].length}return n<e.length&&t.push({value:e.slice(n)}),t}}Object.defineProperty(t,"__esModule",{value:!0}),t.compile=o;var u=n(5),s=r(u),c=/\{\{((?:.|\n)+?)\}\}/g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return e._data[t]},set:function(n){e._data[t]=n}})}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(10),s=n(7),c=n(5),l=r(c),f=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._data=n.data,this._watchers=[],this._target=n.target?document.querySelector(n.target):void 0,Object.keys(this._data).forEach(function(e){i(t,e)}),(0,u.observe)(this._data),this._target&&(0,s.compile)(this._target,this)}return a(e,[{key:"$watch",value:function(e,t){var n=new l["default"](this,e,t);this._watchers.push(n)}}]),e}();t["default"]=f},function(e,t){"use strict";function n(e,t,n){var r=void 0;switch(e){case"push":r=t;break;case"unshift":r=t;break;case"splice":r=t.slice(2)}r&&n.observeArray(r)}Object.defineProperty(t,"__esModule",{value:!0});var r=t.arrayMethods=Object.create(Array.prototype);["push","dequeue","shift","unshift","sort","reverse","splice"].forEach(function(e){var t=Array.prototype[e];Object.defineProperty(r,e,{enumerable:!1,writable:!0,configurable:!0,value:function(){var r=Array.from(arguments),o=t.apply(this,r),i=this.__ob__;return n(e,r,i),i.dep.notify(),o}})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){if(e&&"object"===("undefined"==typeof e?"undefined":s(e))){var t=void 0;return e.hasOwnProperty("__ob__")&&e.__ob__ instanceof p?t=e.__ob__:Object.isExtensible(e)&&(t=new p(e)),t}}function a(e,t,n){var r=new f["default"],o=i(n);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){return f["default"].target&&(r.depend(),o&&o.dep.depend(),Array.isArray(n)&&n.forEach(function(e){e&&e.__ob__&&e.__ob__.dep.depend()})),n},set:function(e){e!==n&&(n=e,r.notify())}})}function u(e,t){e.__proto__=t}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.observe=i;var l=n(4),f=r(l),d=n(9),p=function(){function e(t){o(this,e),this.value=t,this.dep=new f["default"],Object.defineProperty(t,"__ob__",{value:this,enumerable:!1,writable:!0,configurable:!0}),Array.isArray(t)?(u(t,d.arrayMethods),this.observeArray(t)):this.walk(t)}return c(e,[{key:"walk",value:function(e){Object.keys(e).forEach(function(t){a(e,t,e[t])})}},{key:"observeArray",value:function(e){e.forEach(function(e){i(e)})}}]),e}()},function(e,t){"use strict";function n(e,t,n){return addEventListener?this.addEventListener(e.toLowerCase(),t,n):this["on"+e.toLowerCase()]=t,this}function r(e){return this.classList?this.classList.add(e):this.className+=" "+e,this}function o(e){return this.classList?this.classList.remove(e):this.className=this.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|Query)","gi")," "),this}function i(e){return this.classList?this.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(this.className)}function a(e){return"undefined"==typeof e?this.textContent:void(this.textContent=e)}function u(e,t,n){return t=t instanceof Array?t:[t],new Promise(function(o,i){t.forEach(function(t){r.call(e,t)}),setTimeout(function(){o(e)},n)}).then(function(e){return t.forEach(function(t){o.call(e,t)}),e})}Object.defineProperty(t,"__esModule",{value:!0}),t.on=n,t.addClass=r,t.removeClass=o,t.hasClass=i,t.text=a,t.addClassTemp=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(11),a={};t["default"]=function(e){return"string"==typeof e?a[e]?a[e]:a[e]=new u(e):e instanceof Element?new u(e):e===document?(document.on=i.on.bind(document),document):void 0};var u=function(){function e(t){r(this,e),"string"==typeof t?this.el=document.querySelector(t):t instanceof Element&&(this.el=t)}return o(e,[{key:"on",value:function(e,t,n){return i.on.call(this.el,e,t,n),this}},{key:"addClass",value:function(e){return i.addClass.apply(this.el,arguments),this}},{key:"removeClass",value:function(e){return i.removeClass.apply(this.el,arguments),this}},{key:"hasClass",value:function(e){return i.hasClass.apply(this.el,arguments)}},{key:"text",value:function(e){var t=i.text.apply(this.el,arguments);return"undefined"==typeof t&&(t=this),t}}]),e}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Type={Unstarted:"UNSTARTED",Pending:"PENDING",Win:"WIN",Lose:"LOSE",Over:"OVER"},t.Img=[{name:"panda",url:{img:"./img/panda.jpg",bg:"./img/bg_gfpanda.jpg"}},{name:"overwatch",url:{img:"./img/img_overwatch.jpg",bg:"./img/bg_overwatch.jpg"}},{name:"zootopia",url:{img:"./img/img_zootopia.jpeg",bg:"./img/bg_zootopia.jpeg"}},{name:"baymax",url:{img:"./img/img_baymax.jpg",bg:"./img/bg_baymax.jpg"}}]},function(e,t){"use strict";function n(e,t){return Math.floor(Math.random()*(t-e+1)+e)}Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomInt=n}]);
//# sourceMappingURL=bundle.js.map